(function e(b,h,g){function c(k,j){if(!h[k]){if(!b[k]){let a=typeof require=="function"&&require;if(!j&&a){return a(k,!0)}if(i){return i(k,!0)}let f=new Error("Cannot find module '"+k+"'");throw f.code="MODULE_NOT_FOUND",f}let l=h[k]={exports:{}};b[k][0].call(l.exports,function(m){let h=b[k][1][m];return c(h?h:m)},l,l.exports,e,b,h,g)}return h[k].exports}let i=typeof require=="function"&&require;for(let o=0;o<g.length;o++){c(g[o])}return c})({1:[function(c,g,b){(function(j){Object.defineProperty(b,"__esModule",{value:true});let _createClass=function(){function m(p,n){for(let i=0;i<n.length;i++){let descriptor=n[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value" in descriptor){descriptor.writable=true}Object.defineProperty(p,descriptor.key,descriptor)}}return function(q,n,p){if(n){m(q.prototype,n)}if(p){m(q,p)}return q}}();let _jquery=(typeof window!=="undefined"?window["$"]:typeof j!=="undefined"?j["$"]:null),_jquery2=h(_jquery);function h(m){return m&&m.__esModule?m:{"default":m}}function k(m,n){if(!(m instanceof n)){throw new TypeError("Cannot call a class as a function")}}let ShareCount=function(){function v(z,y,x){k(this,v);this.element=z;this.$element=(0,_jquery2["default"])(z);this.site_url="";this.api_url="";this.param_name="";this.send_data={};this.num=y;this.options=x;this.jqxhr={};this.defaults={cache:true,cacheTime:86400000,assign:["fb","hb","tw","pr"],numSelector:"span"};this.count={fb:0,hb:0,tw:0,pr:0}}_createClass(v,[{key:"setParam",value:function s(x){let data={},defaultData={fb:{api_url:"https://graph.facebook.com/",param:{id:x}},hb:{api_url:"https://b.hatena.ne.jp/entry.count",param:{url:x}},tw:{api_url:"https://jsoon.digitiminimi.com/twitter/count.json",param:{url:x}},pr:{api_url:"https://api.pinterest.com/v1/urls/count.json",param:{url:x}}};this.conf.assign.map(function(y){return data[y]=defaultData[y]});return data}},{key:"getCount",value:function p(x,y){let _this=this,d=new _jquery2["default"].Deferred();this.jqxhr[y]=_jquery2["default"].ajax({type:"get",url:this.api_url,cache:false,timeout:10000,dataType:"jsonp",data:this.send_data,success:d.resolve,error:d.reject,context:x}).fail(function(){return _this.jqxhr[y].abort()});return d.promise()}},{key:"takeCount",value:function m(y,x){let that=this,keyArray=y.split(",");(0,_jquery2["default"])(x).each(function(z){let self=_jquery2["default"].extend({},this,{key:keyArray[z]}),obj=this[0]?this[0]:this;switch(self.key){case"fb":if(obj.error){that.count.fb="-"}else{that.count.fb="share" in obj&&"share_count" in obj.share?obj.share.share_count:"0"}break;case"hb":that.count.hb=Array.isArray(obj)?obj[0]:obj||"0";break;case"tw":that.count.tw=obj.count;break;case"pr":that.count.pr=obj.count;break;default:break}});if(that.conf.cache){that.save()}return that.render()}},{key:"setup",value:function q(){let _this2=this,that=this,df=[],data=that.setParam(that.site_url);_jquery2["default"].each(data,function(x,y){let id=new Date().getTime();_this2.api_url=y.api_url;_this2.send_data=y.param;df.push(_this2.getCount(x,id))});_jquery2["default"].when.apply(_jquery2["default"],df).done(function(){return that.takeCount(this.toString(),arguments)}).fail(function(x){return x.abort()})}},{key:"render",value:function n(){let fb=(0,_jquery2["default"])(".ct-fb").eq(this.num).find(this.conf.numSelector),hb=(0,_jquery2["default"])(".ct-hb").eq(this.num).find(this.conf.numSelector),tw=(0,_jquery2["default"])(".ct-tw").eq(this.num).find(this.conf.numSelector),pr=(0,_jquery2["default"])(".ct-pr").eq(this.num).find(this.conf.numSelector);if(this.conf.assign.indexOf("fb")!==-1){fb.html(this.count.fb)}if(this.conf.assign.indexOf("hb")!==-1){hb.html(this.count.hb)}if(this.conf.assign.indexOf("tw")!==-1){tw.html(this.count.tw)}if(this.conf.assign.indexOf("pr")!==-1){pr.html(this.count.pr)}}},{key:"save",value:function r(){let cache=JSON.parse(localStorage.getItem("sc_"+this.site_url))||{},count={},margedCount={};if(this.conf.assign.indexOf("fb")!==-1){count.fb=this.count.fb}if(this.conf.assign.indexOf("hb")!==-1){count.hb=this.count.hb}if(this.conf.assign.indexOf("tw")!==-1){count.tw=this.count.tw}if(this.conf.assign.indexOf("pr")!==-1){count.pr=this.count.pr}count.saveTime=new Date().getTime();if(typeof _jquery2["default"]==="function"){margedCount=_jquery2["default"].extend({},cache,count)}else{margedCount=count||cache}localStorage.setItem("sc_"+this.site_url,JSON.stringify(margedCount));localStorage.setItem("dpsharecount",new Date().getTime())}},{key:"checkCache",value:function t(){let _this3=this,cache=void 0,nocache=void 0,currentTime=void 0;if("localStorage" in window&&window.localStorage!==null){cache=JSON.parse(localStorage.getItem("sc_"+this.site_url))||null;currentTime=new Date().getTime();if(cache){nocache=this.conf.assign.filter(function(x){return cache[x]===undefined});if(nocache.length>0){return this.setup()}}if(cache&&currentTime-cache.saveTime<this.conf.cacheTime){this.conf.assign.map(function(x){return _this3.count[x]=typeof cache[x]==="number"?cache[x]:"-"});return this.render()}}return this.setup()}},{key:"callMethod",value:function w(x){if(x){return x()}return false}},{key:"init",value:function u(){this.site_url=this.element.getAttribute("data-url");this.conf=_jquery2["default"].extend({},this.defaults,this.options);if(this.conf.cache){this.callMethod(this.checkCache())}else{this.callMethod(this.setup())}return this}}]);return v}();b["default"]=ShareCount}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],2:[function(c,g,b){(function(j){let _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol==="function"&&k.constructor===Symbol?"symbol":typeof k},_jquery=(typeof window!=="undefined"?window["$"]:typeof j!=="undefined"?j["$"]:null),_jquery2=h(_jquery),_ShareCount=c("ShareCount"),_ShareCount2=h(_ShareCount);function h(k){return k&&k.__esModule?k:{"default":k}}(function(k){if((typeof g==="undefined"?"undefined":_typeof(g))==="object"&&_typeof(g.exports)==="object"){g.exports=k((typeof window!=="undefined"?window["$"]:typeof j!=="undefined"?j["$"]:null),c("ShareCount"),window)}else{k(_jquery2["default"],window)}})(function(n,m){n.fn.dpShareCount=function k(q){let lastSaveTime=void 0,storage=m.localStorage||null,cacheTime=q.cacheTime||86400000,currentTime=new Date().getTime();if("localStorage" in m&&storage!==null){lastSaveTime=JSON.parse(localStorage.getItem("dpsharecount"))||null;if(lastSaveTime&&currentTime-lastSaveTime>cacheTime){Object.keys(storage).map(function(r){if(~r.indexOf("sc_http")){delete storage[r]}return storage})}}return this.each(function p(r){new _ShareCount2["default"](this,r,q).init()})}})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{ShareCount:1}]},{},[2]);